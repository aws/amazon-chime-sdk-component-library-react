import { Props } from '@storybook/addon-docs/blocks';
import { LoggerProvider } from '../';

<Meta title="SDK Providers/LoggerProvider" />

# LoggerProvider

The `LoggerProvider` provides a `Logger` to log component state changes and lifecycle events such as mounting and unmounting.
The `Logger` can log at various levels governed by [LogLevel](https://aws.github.io/amazon-chime-sdk-js/enums/loglevel.html) from the `amazon-chime-sdk-js`.
It supports browser console logging by default but you can override it by passing a custom `Logger` through props.
Please check usage section below for more examples.

Note that, this `Logger` is different from the one you pass to [MeetingProvider](/story/sdk-providers-meetingprovider--page) props.
The `Logger` passed to `MeetingProvider` logs only `amazon-chime-sdk-js` related logs.

## Provides
```typescript
logger: Logger | undefined;
```
You can access the value provided using the `useLogger` hook.

## Importing

```jsx
import { LoggerProvider } from 'amazon-chime-sdk-component-library-react';
```

## Props

<Props of={LoggerProvider} />

## Usage

### Default

```jsx
import React, { useEffect } from 'react';
import { MeetingProvider, LoggerProvider, useLogger } from 'amazon-chime-sdk-component-library-react';

const App = () => (
  <LoggerProvider>
    <MyApp />
  </LoggerProvider>
);

const MyApp = () => {
  const logger = useLogger();
  logger.info('This is an info log');
  // To see debug level logs, pass the logLevel as LogLevel.DEBUG
  // By default, the logLevel is set to LogLevel.INFO which omits debug logs.
  logger.debug('This is a debug log');
  logger.error('This is an error log');
  logger.warn('This is a warning log');
  return (
    <MeetingProvider>
      <SubComponent />
    </MeetingProvider>
  )
};

const SubComponent = () => {
  const logger = useLogger();
  useEffect(() => {
    logger.info('SubComponent mounted');
    return () => logger.info('SubComponent unmounted');
  }, []);
};
```

### Custom - Can change the logger name and log level.

Provide a `name` and a `logLevel` through props to customize the default `Logger` creation.

```jsx
import React, { useEffect } from 'react';
import { MeetingProvider, LoggerProvider, useLogger } from 'amazon-chime-sdk-component-library-react';

const App = () => (
  <LoggerProvider name={'ChimeReactLogger'} logLevel={LogLevel.DEBUG}>
    <MyApp />
  </LoggerProvider>
);

const MyApp = () => {
  const logger = useLogger();
  logger.info('This is an info log');
  // To see debug level logs, pass the logLevel as LogLevel.DEBUG
  // By default, the logLevel is set to LogLevel.INFO which omits debug logs.
  logger.debug('This is a debug log');
  logger.error('This is an error log');
  logger.warn('This is a warning log');
  return (
    <MeetingProvider>
      <SubComponent />
    </MeetingProvider>
  );
};

const SubComponent = () => {
  const logger = useLogger();
  useEffect(() => {
    logger.info('SubComponent mounted');
    return () => logger.info('SubComponent unmounted');
  }, []);
};
```

### Custom - Can provide a custom `Logger`.

```jsx
import React, { useEffect } from 'react';
import { MeetingProvider, LoggerProvider, useLogger } from 'amazon-chime-sdk-component-library-react';

const App = () => {
  const createMeetingResponse = // `CreateMeeting` API Response.
  const createAttendeeResponse = // `CreateAttendee` API Response

  // Create `MeetingSessionConfiguration`
  const config = new MeetingSessionConfiguration(createMeetingResponse, createAttendeeResponse);
  const batchSize = 20;
  const intervalMs = 2000;
  const url = <HTTP URL to post the logs to>;
  const logLevel = LogLevel.INFO;

  // Create `MeetingSessionPOSTLogger`
  const postLogger = new MeetingSessionPOSTLogger(
    'ChimeSDKReactPOSTLogger',
    config,
    batchSize,
    intervalMs,
    url,
    logLevel
  );

  // Provide multiple loggers using `MultiLogger`
  const consoleLogger = new ConsoleLogger('ReactSDKConsoleLogger', LogLevel.INFO);
  const multiLogger = new MultiLogger([consoleLogger, postLogger]);
  return (
    <LoggerProvider logger={multiLogger}>
      <MyApp />
    </LoggerProvider>
  );
};

const MyApp = () => {
  const logger = useLogger();
  logger.info('This is an info log');
  // To see debug level logs, pass the logLevel as LogLevel.DEBUG
  // By default, the logLevel is set to LogLevel.INFO which omits debug logs.
  logger.debug('This is a debug log');
  logger.error('This is an error log');
  logger.warn('This is a warning log');
  return (
    <MeetingProvider>
      <SubComponent />
    </MeetingProvider>
  );
};

const SubComponent = () => {
  const logger = useLogger();
  useEffect(() => {
    logger.info('SubComponent mounted');
    return () => logger.info('SubComponent unmounted');
  }, []);
};
```
